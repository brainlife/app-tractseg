#!/bin/bash
#PBS -l nodes=1:ppn=8,walltime=4:00:00
#PBS -l vmem=31gb
#PBS -N tractseg
#PBS -V

set -x
set -e

time singularity exec -e docker://brainlife/tractseg:1.7.1 ./run.sh

#create tractseg output
mkdir -p output
ln -sf ../tractseg_output/bundle_segmentations output/masks

#create raw output
ln -sf tractseg_output raw

#create wmc output
mkdir -p wmc
ln -sf ../output.mat wmc/output.mat
ln -sf ../output_fibercounts.txt wmc/output_fibercounts.txt
ln -sf ../tracts wmc/tracts

#create tractmasks output
mkdir -p endingmasks
ln -sf ../tractseg_output/endings_segmentations endingmasks/masks
